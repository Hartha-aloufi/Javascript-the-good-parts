#### الفصل الثالث

# الكائنات

الأنواع البسيطة في الجافا سكربت هي: الأرقام والسلاسل النصية والقيم البوليانية-`ture` `false`- و `null` وأيضا `undefined`. وجميع القيم الأُخرى هي عبارةٌ عن كائنات. وتعتبر الأرقام والسلاسل النصيَة شبيهةً بالكائنات من حيث امتلاكها للتوابع، لكنها غير قابلة للتعديل. الكائنات في الجافا سكربت هي  are mutable keyed collections، في الجافا سكربت، المصفوفات والدوال والتعابير النمطية جميعهن كائنات وبالتأكيد الكائنات أيضا كائنات. 

الكائن هو حاوية من الخصائص، حيث تمتلك الخاصيَة اسماً وقيمة، يمكن استخدام أي سلسلة نصية بما فيها السلسلة النصية الفارغة كاسم للخاصيَة. ويمكن استخدام أي قيمة في الجافا سكربت كقيمة للخاصيَة عدا الـ `undefined`. 

الكائنات في الجافا سكربت غير تابعة للأصناف(class-free). وليس هناك قيود على أسماء الخصائص أو قيمها. الكائنات مفيدة لجمع وتنظيم البيانات. يمكن أن يحوي الكائن على كائن آخر، وبذلك يكون من السهل تمثيل التشجيرات والمخططات والأبراج(graphs).

تمتلك الجافا سكربت ميزة الربط النماذجي والتي تسمح للكائن بوراثة خصائص كائن آخر. وعندما تستخدم جيداً، يمكن أن تقلل من استهلاك الوقت والذاكرة اللازمين لتهيئة الكائنات.

### الكائن الحَرفي

الكائن الحرفي يقدم تدوين مناسباً جداً لإنشاء كائنات جديدة. الكائن الحرفي عبارة عن حاصرتان يحيطان بصفر أو أكثر من زَوجي "اسم/قيمة". يمكن أن يوجد الكائن الحرفي في أي مكان يمكن أن يوجد فيه تعبير.

```javascript
var empty_object = {};
var stooge = {
 "first-name": "Jerome",
 "last-name": "Howard"
};
```

اسم الخاصية يمكن أن يكون أي سلسلة نصية بما يتضمن السلسلة النصية الفارغة، وعلامة التنصيص حول اسم الخاصية اختيارية بشرط أن يكون الاسم صالحاً وفق الجافا سكربت وأيضاً أن لا يكون كلمة محجوزة. لذا علامتي التنصيص إجبارية حول `"first-name"` واختيارية حول `first_name`. وتستخدم الفواصل للفصل بين الخصائص.

يمكن الحصول على قيم الخواص من أي تعبير، بما في ذلك الكائنات الحرفية. حيث يصبح الكائن متداخلاً:

```javascript
var flight = {
     airline: "Oceanic",
     number: 815,
     departure: {
         IATA: "SYD",
         time: "2004-09-22 14:55",
         city: "Sydney"
     },
     arrival: {
         IATA: "LAX",
         time: "2004-09-23 10:42",
         city: "Los Angeles"
     }
};
```

### الاسترجاع

يمكن استرجاع القيم من الكائنات بكاتبة تعبير نَصّي (أي أيٌّ تعبير يٌنتج سلسلة نصيّة) داخل زوجين من الأقواس المعقوفة `[]` تَلحق اسم الكائن. وإذا كان التعبير النَصّي سلسلة نصيّة حرفية لا تخالف قواعد الأسماء في الجافا سكربت ولا هي كلمة محجوزة فعندها يمكن استخدام رمز النقطة `.`، وهي طريقة أفضل حيث أنها أكثر إحكاماً وأسهل قراءةً: 

```javascript
stooge["first-name"]  // "Jerome"
flight.departure.IATA // "SYD"

```

ستحصل على قيمة `undefined` إذا حاولت استرجاع قيمة لخاصية غير موجودة:

```javascript
stooge["middle-name"] // undefined
flight.status         // undefined
stooge["FIRST-NAME"]  // undefined
```

 

 يمكن استخدام العامل `||` لتعين قيم افتراضية:

```javascript
var middle = stooge["middle-name"] || "(none)";
var status = flight.status         || "unknown";
```

 محاولة استرجاع قيم من الـ `undefined` سيؤدي الى رمي اعتراض(exception) من نوع `TypeError`. ويمكن التحصن ضده باستخدام العامل `&&`:

```javascript
flight.equipment						   // undefined
flight.equipment.model 				       // throw "TypeError"
flight.equipment && flight.equipment.model // undefined
```

### التحديث

يمكن تحديث قيمة في كائن ما من خلال الاسناد. فإذا كانت الخاصية موجودة مسبقاً في الكائن، فسيتم استبدالها: 

```javascript
stooge['first-name'] = 'Jerome';
```

وإذا لم تكن الخاصية موجودة مسبقاً في الكائن، فسيتم اضافتها:

```javascript
stooge['middle-name'] = 'Lester';
stooge.nickname = 'Curly';
flight.equipment = {
 model: 'Boeing 777'
};
flight.status = 'overdue';
```

### المرجع

تمرر الكائنات بواسطة مرجعها فلا يتم نسخها ابداً عند التمرير: 

```javascript
var x = stooge;
x.nickname = 'Curly';
var nick = stooge.nickname;
 //قيمة المتغير nick هي 'Culry' لأن x و stooge
 // هما مرجعين لنفس الكائن
var a = {}, b = {}, c = {};
 //كل المتغيرات السابقة تشير الى
 // كائنات فارغة مختلفة
a = b = c = {};
 // كل المتغيرات السابقة تشير الى
 // نفس المتغير الفارغ

```

### النموذج

كل الكائنات مربوطة بكائن نماذجي والتي يمكن أن ترث الخصائص منه. حيث أن كل الكائنات المنشأة بكائنات حرفية مرتبطة ب `Object.prototype` وهو كائن يأتي ضمن الجافا سكربت نفسها.

عندما تقوم بإنشاء كائن جديد، يمكنك اختيار الكائن الذي سيكون نموذجه. الآلية التي تقدمها الجافا سكربت لتنفيذ هذا فوضوية ومعقدة، لكن يمكن تبسيطها بشكل فعال. سنقوم بإضافة تابع `create` للدالة `Object`. 



```javascript
if (typeof Object.create !== 'function') {
    Object.create = function (o) {
        var F = function () {};
        F.prototype = o;
        return new F();
    };
}
var another_stooge = Object.create(stooge);
```

 لا يملك رابط النموذج أي تأثير على التحديثات، أي عندما نقوم بإجراء تعديل على كائن ما، لا يتم مس نموذج ذلك الكائن ولا يتأثر بالتحديث:

```javascript
another_stooge['first-name'] = 'Harry';
another_stooge['middle-name'] = 'Moses';
another_stooge.nickname = 'Moe';
```

يستخدم رابط النموذج فقط في الاسترجاع، فعندما نحاول استرجاع قيمةَ خاصيةٍ من كائن ما، وذلك الكائن يفتقر  الى تلك الخاصية، عندها تقوم الجافا سكربت بمحاولة استرجاع تلك القيمة من كائن النموذج، وإن كان ذلك الكائن أيضاً يفتقر الى تلك الخاصية، فسنستمر الى نموذج الذي بعده، وهكذا ننتهي الى `Object.prototype`. فإذا لم نجد تلك الخاصية في كامل سلسلة النماذج، فستكون القيمة هي `undefined`. وهذا ما يدعى بالتفويض(delegation). 

العلاقة النماذجية علاقة ديناميكية، فإذا اضفنا خاصية جديدة الى أحد النماذج، فستكون تلك الخاصية مرئية لجميع الكائنات المعتمدة على ذلك النموذج:

```javascript
stooge.profession = 'actor';
another_stooge.profession // 'actor'
```

سوف نرى المزيد عن سلسلة النماذج في الفصل السادس.

### 

