#### الفصل الأول

---

# الأجزاء الجيدة



عندما كنت مبرمجاً يافعاً، كنت أَودُ أن اتعلم كل مزايا(features) اللغة التي أكتب بها، وكنت أُحاول أيضاً استخدام كلَ تلك الميزات عندما أُبرمج، أفترض أنها كانت طريقة للاستعراض، وأفترض أنها نجحت لأني كنت الشخص الذي تبحث عنه إذا أردت أن تتعلم كيف تستخدمُ ميزةً معينة.



في النهاية أدركت أن بعض تلك المزايا كانت مُشكِلَةً. أدى بعضها الى جعل الشيفرة(code) صعبة القراءة أو التعديل، بعضها حفزني على الكتابة بأُسلوب مخادع جداً ومولدٍ للأخطاء(error-prone). وتصميم بعض هذا المزايا كان خاطئً، فأحياناً مصمّمي اللّغة يرتكبون الأخطاء.



أكثر لغات البرمجة تمتلك أجزاءً جيدة وأجزاءً سيئة، وقد اكتشفت أنه يمكنني أن اصبح مبرمجاً أفضل إذا اقتصرت على الأجزاء الجيدة فقط وتجنبت السيئة. فقبل كل شيء، كيف يمكنك بناءٌ شيءٍ جيد من أجزاء سيئة؟



من النادر أن تتمكن لجان المعايير من إزالة العيوب من لغة برمجةٍ ما لأن فعل ذلك سيؤدي الى إعطاب كل البرامج التي تعتمد على تلك الأجزاء السيئة، هم عادةً عاجزون عن فعل أي شيء سوى إضافة المزيد من المزايا فوق كومة العيوب الموجودة مسبقاً. وهذه المزايا الجديدة لا تنسجم دائما بشكل متناغم، وبالتالي تنتج المزيد من الأجزاء السيئة. لكن بالطبع لديك القدرة على تحديد مجموعتك الخاصة -الأجزاء الجيدة- وكتابة البرامج حصراً بها. 



الجافا سكربت هي لغة أكبر من الأجزاء السيئة التي بها. فهي خرجت من العدم الى العالمية في ظرف زمني قصير جداً وبشكلٍ مثيرٍ للقلق، فهي لم تخضع لفترة تجريبية في المختبر حيث يمكن صقلها، فقد خرجت مباشرةً الى Netscape Navigator 2(متصفح انترنت) كما هو.

عندما فشلت الـ Java applets أصبحت الجافا سكربت افتراضياً "لغة  الويب" لذلك فإن شعبيتها لا علاقة لها تماما بجودتها كلغة برمجة.



لحسن الحظ، الجافا سكربت بها أجزاء جيدة بصورة غير اعتيادية، ففيها جمال وأناقة ولغة تعبيرية عالية مدفونة تحت كومة من حسن النوايا والأخطاء الفادحة. والوجه الحسن للجافا سكربت متخفٍ بشكل فعّال جعل الرأي السائد عنها أنها بشعة وغير كفؤة. ونيتي هنا أن أُظهر محاسنها فهي لغة ديناميكية استثنائية. الجافا سكربت هي كمكعب الرخام وأنا سأقوم بإزالة المزايا الغير جميلة حتى تكشف الطبيعة الحقيقية للغة عن نفسها. أنا أُؤمن أن المجموعة الأنيقة التي اقتطعتها متفوقة بشكل كبير على اللغة ككل، فهي أكثر موثوقيةً(Reliable) ومقروئيةً(Readable) وأكثر قابلية للصيانة(Maintainable).



هذا الكتاب لا يحاول شرح اللّغة بشكل كامل. عوضاً عن ذلك، هو يركز على الأجزاء الجيدة ويحذر بين الحين والآخر من الأجزاء السيئة. المجموعة التي ستشرح يمكن بها بناء برامج موثوقة ومقروءة كانت كبيرة أم صغيرة. بالتركيز على الأجزاء الجيدة يمكننا اختصار وقت التعلم وزيادة متانته وأيضاً إنقاذ بعض الأشجار.



ربما أكبر فائدة من دراسة الأجزاء الجيدة هو تلافي الحاجة الى تناسي الأجزاء السيئة. فنسيان الأنماط السيئة أمر في غاية الصعوبة. إنها مهمة مؤلمة أغلبنا يواجِهٌها بممانعة شديدة. أحياناً تجزء اللغة لجعل العمل أفضل للطلاب. لكن في هذه الحالة، أنا أُجزئ الجافا سكربت لجعل العمل أفضل للمهنين.



## لماذا الجافا سكربت؟

الجافا سكربت لغة مهمة لأنها لغة متصفحات الشبكة، فارتباطها بالمتصفحات جعلها من أشهر لغات البرمجة في العالم. في نفس الوقت فهي من أكثر لغات البرمجة المٌزدَرَية في العالم. الـ API الخاصة بالمتصفح و Document Object Model (DOM) مريعان جداً. والجافا سكربت لومت بغير حق. فالتعامل مع الـ DOM سيكون صعباً بأي لغة كانت، فلقد طور بشكل غير متسق وبمعيارية سيئة. هذا الكتاب لا يتطرق للـ DOM إلا قليلاً، لأني اعتقد أن تأليف كتاب عن الأجزاء الجيدة به لهو أمرٌ صعب للغاية. 



الجافا سكربت غالباً مزدرية بسبب "بعض اللغات الاُخرى". اذا كنت  جيداً في "بعض اللغات الاُخرى" وكان عليك أن تبرمج في بيئة لا تدعم سوى الجافا سكربت، عندها فأنت مجبر على ذلك، وهذا مزعج. في وضع كهذا، أغلب الناس لا يهتمون حتى بتعلم اللّغة اولاً وبعد ذلك يتفاجأون عندما يعموا أن الجافا سكربت تمتلك اختلافات بارزة وهامة عن "بعض لغات البرمجة" التي يفضلون استخدامها.



المدهش في الجافا سكربت أنه يمكنك إتمام العمل بها بدون الحاجة الى معرفة الكثير عنها أو حتى دون معرفة الكثير عن البرمجة. إنها لغة تمتلك قدرة تعبيرية عالية ومن الأفضل أن لك تعرف ما تفعله فالبرمجة عمل صعب ولا يجب أن تؤخذ بجهل. 



## تحليل الجافا سكربت

بنيت الجافاسكربت على بعض الأفكار  الجيدة جداً والقليل من الأفكار السيئة جداً. الأفكار الجيدة تتضمن الدوال(Functions) وفضفاضية النوع(Loose typing) والتدوين الحرفي للكائن(Object literal notation). وتتضمن الأجزاء السيئة نموذج البرمجة القائم على المتغيرات الشيوعية(Global variables).

دوال الجافا سكربت هي كائناتُ درجةٍ أُولى(First class object) مع نطاق ثابت(Static scope) وهي أيظاً أول لغة وظيفية(Functional language) تصبح سائدة.

بالغوص عميقاً في الجافا سكربت، فهي تمتلك قواسم مشتركة مع لغتي لِزب(Lisp) وسكيم(Scheme) أكثر مما تمتلكه مع لغة الجافا. إنها لِزب في ثوبِ سي(C). ذلك يجعلها لغة قوية بشكل لافت للنظر.  



الموضة في أغلب لغات البرمجة هذه الأيام تتطلب إحكام الأنواع(Strong typing). النظرية هي أن إحكام الأنواع يتيح للمترجمات(Compilers) ظبط أصنافٍ كثيرة من الأخطاء في وقت الترجمة(Compile time) وكلما أسرعنا في اكتشاف الأخطاء وإصلاحها، قلت تكلفتها علينا. وبما أن الجافا سكربت فضفاضية النوع فإن مترجمات الجافا سكربت عاجزة عن ظبط أخطاء الأنواع. هذا يمكن أن يكون مزعجاً للأشخاص القادمين إلى الجافا سكربت من لغات محكمة النوع. لكن يتضح أن إحكام الأنوع لا يغني عن الحاجة عن الإختبار الحذر للبرنامج. وقد وجدتُ أن الأخطاء التي يظبطها إحكام النوع ليست هي الأخطاء التي أقلق بشأنها. في الجهة الأٌخرة وجدت أن فضفاضية النوع تعطي حرية أكبر, فلا احتاج إلى صنع تشجير معقد للأصناف(class hierarchies). ولا أحتاج أبداً أن أتصارع مع نظام الأنوع للحصول على السلوك(Behavior) الذي أُريد. 



الجافا سكربت لديها تدوين حرفي للكائن قوي جداً. يمكن إنشاء الكائنات ببساطة من خلال كتابة مكوناته. هذا التدوين كان الإلهام للجيسون(JSON)، تنسيق تبادل البيانات الشهير (سيكون هناك المزيد عن الجيسون في الملحق هـ)



الوراثة النماذجية(Prototypal inheritance) الميز المثيرة للجدل في الجافا سكربت. الجافا سكربت تمتلك نظام كائنات عديم الصنف(Class-free object stystem) حيث ترث الكائنات فيه من كائنات أٌخرى مباشرةً. وهذه حقاً ميزة قوية لكنها غير مألوفة لمن دُرِّب تدريباً تقليدياً. سوف تصاب بالإحباط إذا حاولت تطبيق أنماط تصميم (Design patterns) تقليدية بشكل مباشر في الجافا سكربت، لكن اذا تعلمت التعامل مع وراثتها النماذجية سيكون جهدك مُجَزياً. 



ذٌمَّت الجافا سكربت كثيراً وبشكل غير عادل على اختيارها افكارها الرئيسية، وعلى الرغم من ذلك فغالباً ما كانت هذه الاختيارات جيدة. لكن كان هناك خيار واحدٌ سيئ بشكل خاص وهو اعتمادها على المتغيرات الشيوعية(Global variables) للربط. فجميع متغيرات المستوى الأعلى(top-level) يتم رميها في نطاق(namespace) مشترك يسمى "الكائن الشيوعي(Global variable)". وهذا أمر سيئ لأن 





